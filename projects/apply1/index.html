<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Analysis of HIV Drug Resistance | Jiazhi He</title> <meta name="author" content="Jiazhi He"> <meta name="description" content="STAT 2131 Course Final Project at Pitt"> <meta name="keywords" content="Jiazhi He, homepage, academic-website, jiazhi he, pitt"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://he-jiazhi.github.io/projects/apply1/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Jiazhi </span>He</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">Teaching</a> </li> <li class="nav-item "> <a class="nav-link" href="/Friends/">Friends</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Analysis of HIV Drug Resistance</h1> <p class="post-description">STAT 2131 Course Final Project at Pitt</p> </header> <article> <p>The scientific goal is to determine which mutations of the Human Immunodeficiency Virus Type 1 (HIV-1) are associated with drug resistance. The data set, publicly available from the Stanford HIV Drug Resistance Database <a href="http://hivdb.stanford.edu/pages/published_analysis/genophenoPNAS2006/" rel="external nofollow noopener" target="_blank">Stanford HIV Drug Resistance Database</a>, was originally analyzed in (Rhee et al. 2006).</p> <h2 id="preparing-the-data">Preparing the data</h2> <p>The data set consists of measurements for three classes of drugs: protease inhibitors (PIs), nucleoside reverse transcriptase (RT) inhibitors (NRTIs), and nonnucleoside RT inhibitors (NNRTIs). Protease and reverse transcriptase are two enzymes in HIV-1 that are crucial to the function of the virus. This data set seeks associations between mutations in the HIV-1 protease and drug resistance to different PI type drugs, and between mutations in the HIV-1 reverse transcriptase and drug resistance to different NRTI and NNRTI type drugs (The raw data are saved as <code class="language-plaintext highlighter-rouge">gene_df</code>).</p> <p>In order to evaluate our results, we compare with the treatment-selected mutation panels created by (Rhee et al. 2005), which can be viewed as the ground true. These panels give lists of HIV-1 mutations appearing more frequently in patients who have previously been treated with PI, NRTI, or NNRTI type drugs, than in patients with no previous exposure to that drug type. Increased frequency of a mutation among patients treated with a certain drug type implies that the mutation confers resistance to that drug type (The raw data are saved as <code class="language-plaintext highlighter-rouge">tsm_df</code>).</p> <p>To simplify the analysis, in this project we will confine our attention to the PI drugs.</p> <pre><code class="language-{r}">drug_class = 'PI' # Possible drug types are 'PI', 'NRTI', and 'NNRTI'
</code></pre> <h2 id="fetching-and-cleaning-the-data">Fetching and cleaning the data</h2> <p>First, we download the data and read it into data frames.</p> <pre><code class="language-{r}">base_url = 'http://hivdb.stanford.edu/_wrapper/pages/published_analysis/genophenoPNAS2006'
gene_url = paste(base_url, 'DATA', paste0(drug_class, '_DATA.txt'), sep='/')
tsm_url = paste(base_url, 'MUTATIONLISTS', 'NP_TSM', drug_class, sep='/')

gene_df = read.delim(gene_url, na.string = c('NA', ''), stringsAsFactors = FALSE)
tsm_df = read.delim(tsm_url, header = FALSE, stringsAsFactors = FALSE)
names(tsm_df) = c('Position', 'Mutations')
</code></pre> <p>A small sample of the data is shown below.</p> <pre><code class="language-{r}">head(gene_df, n=6)
</code></pre> <table> <thead> <tr class="header"> <th align="right">APV</th> <th align="right">ATV</th> <th align="right">IDV</th> <th align="right">LPV</th> <th align="right">NFV</th> <th align="right">RTV</th> <th align="right">SQV</th> <th align="left">P1</th> <th align="left">P2</th> <th align="left">P3</th> <th align="left">P4</th> <th align="left">P5</th> <th align="left">P6</th> <th align="left">P7</th> <th align="left">P8</th> <th align="left">P9</th> <th align="left">P10</th> </tr> </thead> <tbody> <tr class="odd"> <td align="right">2.3</td> <td align="right">NA</td> <td align="right">32.7</td> <td align="right">NA</td> <td align="right">23.4</td> <td align="right">51.6</td> <td align="right">37.8</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">I</td> </tr> <tr class="even"> <td align="right">76.0</td> <td align="right">NA</td> <td align="right">131.0</td> <td align="right">200.0</td> <td align="right">50.0</td> <td align="right">200.0</td> <td align="right">156.0</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">F</td> </tr> <tr class="odd"> <td align="right">2.8</td> <td align="right">NA</td> <td align="right">12.0</td> <td align="right">NA</td> <td align="right">100.0</td> <td align="right">41.0</td> <td align="right">145.6</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> </tr> <tr class="even"> <td align="right">6.5</td> <td align="right">9.2</td> <td align="right">2.1</td> <td align="right">5.3</td> <td align="right">5.0</td> <td align="right">36.0</td> <td align="right">13.0</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">I</td> </tr> <tr class="odd"> <td align="right">8.3</td> <td align="right">NA</td> <td align="right">100.0</td> <td align="right">NA</td> <td align="right">161.1</td> <td align="right">170.2</td> <td align="right">100.0</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">I</td> </tr> <tr class="even"> <td align="right">82.0</td> <td align="right">75.0</td> <td align="right">400.0</td> <td align="right">400.0</td> <td align="right">91.0</td> <td align="right">400.0</td> <td align="right">400.0</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">-</td> <td align="left">I</td> </tr> </tbody> </table> <pre><code class="language-{r}">head(tsm_df, n=6)
</code></pre> <table> <thead> <tr class="header"> <th align="right">Position</th> <th align="left">Mutations</th> </tr> </thead> <tbody> <tr class="odd"> <td align="right">10</td> <td align="left">F R</td> </tr> <tr class="even"> <td align="right">11</td> <td align="left">I</td> </tr> <tr class="odd"> <td align="right">20</td> <td align="left">I T V</td> </tr> <tr class="even"> <td align="right">23</td> <td align="left">I</td> </tr> <tr class="odd"> <td align="right">24</td> <td align="left">I</td> </tr> <tr class="even"> <td align="right">30</td> <td align="left">N</td> </tr> </tbody> </table> <p>In <code class="language-plaintext highlighter-rouge">tsm_df</code>, the variable <code class="language-plaintext highlighter-rouge">Position</code> denotes the position of the mutations that are associated with drug-resistance, while <code class="language-plaintext highlighter-rouge">Mutations</code> indicating the mutation type.</p> <p>The gene data table has some rows with error flags or nonstandard mutation codes. For simplicity, we remove all such rows.</p> <pre><code class="language-{r}"># Returns rows for which every column matches the given regular expression.
grepl_rows &lt;- function(pattern, df) {
  cell_matches = apply(df, c(1,2), function(x) grepl(pattern, x))
  apply(cell_matches, 1, all)
}

pos_start = which(names(gene_df) == 'P1')
pos_cols = seq.int(pos_start, ncol(gene_df))
valid_rows = grepl_rows('^(\\.|-|[A-Zid]+)$', gene_df[,pos_cols])
gene_df = gene_df[valid_rows,]
</code></pre> <h2 id="preparing-the-regression-matrix">Preparing the regression matrix</h2> <p>We now construct the design matrix \(X\) and matrix of response vectors \(Y\). The features (columns of \(X\)) are given by mutation/position pairs. Define</p> \[X_{i,j} = 1 \text{ if the } i \text{th patient has the } j \text{th mutation/position pair and 0 otherwise}\\ Y_{i,k} = \text{resistance of patient } i \text{ to drug } k.\] <p>For example, in the sample for PI type drugs, three different mutations (A, C, and D) are observed at position 63 in the protease, and so three columns of $X$ (named P63.A, P63.C, and P63.D) indicate the presence or absence of each mutation at this position.</p> <pre><code class="language-{r}"># Flatten a matrix to a vector with names from concatenating row/column names.
flatten_matrix &lt;- function(M, sep='.') {
  x &lt;- c(M)
  names(x) &lt;- c(outer(rownames(M), colnames(M),
                      function(...) paste(..., sep=sep)))
  x
}

# Construct preliminary design matrix.
muts = c(LETTERS, 'i', 'd')
X = outer(muts, as.matrix(gene_df[,pos_cols]), Vectorize(grepl))
X = aperm(X, c(2,3,1))
dimnames(X)[[3]] &lt;- muts
X = t(apply(X, 1, flatten_matrix))
mode(X) &lt;- 'numeric'

# Remove any mutation/position pairs that never appear in the data.
X = X[,colSums(X) != 0]

# Extract response matrix.
Y = gene_df[,4:(pos_start-1)]
</code></pre> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2023 Jiazhi He. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>